---
title: "Finalizing Setup" #
lang: zh_CN
permalink: /finalizing-setup.html
---

To use the [magnet](https://en.wikipedia.org/wiki/Magnet_URI_scheme) links on this page, you will need a torrent client like [Deluge](http://dev.deluge-torrent.org/wiki/Download)
{: .notice--success}

#### 步骤概览

{% capture notice-2 %}

The file `boot.firm` is what is launched by boot9strap itself after it finishes loading off of NAND, and can be any valid arm9 payload in the FIRM format. This file can be replaced at any time, although Luma3DS allows for the launch of other arm9 payloads in the FIRM format using the Luma3DS chainloader.
<br><br>
本教程中，我们使用[AuroraWright](https://github.com/AuroraWright/)提供的Luma3DS来直接启动一个破解过的SysNAND，使我们能完全避免使用RedNAND，从而极大地简化使用破解的3DS系统的步骤，并节省SD卡的空间。
<br><br>
在这个过程当中，我们还会安装像下面所示的几个工具：    

+  **FBI** *(用来安装CIA格式的游戏和程序)*
+  **Themely** *(installs custom themes)*
+  **Luma3DS Updater** *(用来更新Luma3DS固件)*
+  **GodMode9** *(multipurpose tool which can do NAND and cartridge functions)*

{% endcapture %}

<div class="notice--info">{{ notice-2 | markdownify }}</div>

#### 你需要：

* 最新版本的[Luma3DS](https://github.com/AuroraWright/Luma3DS/releases/latest) *（`.7z`压缩包）*
* The latest release of [Themely](https://github.com/ErmanSayin/Themely/releases/latest) *(the `.cia` file)*
* 最新版本的[hblauncher_loader](https://github.com/yellows8/hblauncher_loader/releases/latest)
* 最新版本的 [GodMode9](https://github.com/d0k3/GodMode9/releases/latest)
* The latest release of [DSP1](https://github.com/zoogie/DSP1/releases/latest)
* 最新版本的[FBI](https://github.com/Steveice10/FBI/releases/latest)
* The latest fork of [Luma3DS Updater](https://github.com/KunoichiZ/lumaupdate/releases/latest)
* **Old 3DS and 2DS Only:** The Old 3DS 11.2.0-35 [otherapp payload](https://smealum.github.io/3ds/#otherapp) for your region

#### 操作指南

##### 第一部分 - 准备工作

1. 将你的 SD 卡插入到您的计算机
1. 在SD卡的根目录下创建 `cias` 文件夹，如果已有此文件夹，则不用创建
1. Create a folder named `hblauncherloader` on the root of your SD card if it does not already exist
1. 解压hblauncher_loader压缩包，并复制 `hblauncher_loader.cia` 到你SD卡的 `/cias/` 目录
1. Copy `lumaupdater-v2.0.cia` from the Luma3DS Updater `.zip` to the `/cias/` folder on your SD card
1. 解压FBI压缩包，并复制 `FBI.cia` 到你SD卡的 `/cias/` 目录
1. Copy `DSP1.cia` to the `/cias/` folder on your SD card
1. Copy `Themely.cia` to the `/cias/` folder on your SD card

    ![]({{ base_path }}/images/screenshots/cias-file-layout.png)
    {: .notice--info}

1. Copy `boot.firm` from the Luma3DS `.7z` to the root of your SD card
1. 在你SD卡的根目录创建一个叫 `luma` 的文件夹
1. 在SD卡的 `luma` 文件夹里创建 `payloads` 文件夹
1. Copy `GodMode9.firm` from the GodMode9 `.zip` to the `/luma/payloads/` folder on your SD card
1. **Old 3DS and 2DS Only:** Copy the Old 3DS 11.2.0-35 otherapp payload for your region to the `/hblauncherloader/` folder on your SD card
1. **Old 3DS and 2DS Only:** Rename the Old 3DS 11.2.0-35 otherapp payload on your SD card to match your region:
  + **EUR:** `OLD-11-4-0-37-EUR.bin`
  + **JPN:** `OLD-11-4-0-37-JPN.bin`
  + **KOR:** `OLD-11-4-0-37-KOR.bin`
  + **USA:** `OLD-11-4-0-37-USA.bin`

    ![]({{ base_path }}/images/screenshots/finalizing-setup-file-layout.png)
    {: .notice--info}

1. If your device is on a version between 3.0.0 and 4.5.0 (inclusive), your device will not boot until you manually download the required firmware:
  + 下载[这个文件](http://nus.cdn.c.shop.nintendowifi.net/ccs/download/0004013800000002/00000056) 并重命名为 `firmware.bin`
  + 下载[这个文件](http://nus.cdn.c.shop.nintendowifi.net/ccs/download/0004013800000002/cetk)
  + 复制 `firmware.bin` 和 `cetk` 到SD卡的 `/luma/` 文件夹下
  + Delete both of these files after updating your device later in these instructions
1. Reinsert your SD card into your device

##### Section II - Configuring Luma3DS

1. Boot your device to enter the Luma3DS configuration menu
  + If you get a black screen, [follow this troubleshooting guide](troubleshooting#ts_sys_b9s)
1. 使用方向键和A键来启用以下设置：    
  + **"Show NAND or user string in System Settings"**
1. 按下(Start)键保存设置并重启
  + 如果出现黑屏，请照常进行接下来的教程   

##### Section III - Updating the System

If, before following this guide, you already had an EmuNAND setup and would like to move the contents of your previous EmuNAND to your new SysNAND CFW, now is the time to [follow Move EmuNAND](move-emunand) instead of doing the first nine steps in this section.
{: .notice--info}

1. Update your device by going to System Settings, then "Other Settings", then going all the way to the right and using "System Update"
  + Updates while using B9S + Luma (what you have) are safe
  如果这一步出错，则将DNS设置改为”auto”（自动）
  + If this still gives you an error and your NAND is below 9.2.0, [follow 9.2.0 CTRTransfer](9.2.0-ctrtransfer), then try updating again

##### Section IV - Injecting FBI

1. Reboot holding (Start) during boot to launch the Luma3DS chainloader menu
1. Launch GodMode9 by pressing (A)
1. Navigate to `[0:] SDCARD` -> `cias`
1. Press (A) on `FBI.cia` to select it, then select "CIA image options...", then select "Mount image to drive"
1. Press (A) on the `.app` file, then select "NCCH image options", then select "Inject to H&S"
1. Press (A) to unlock SysNAND (lvl1) writing, then input the key combo given
1. 按(A)键继续
1. 按（Start）重启你的设备
1. 如果你依然进入的是系统内置的Health & Safety应用，并且之前曾经用Gateway进行过降级，参见这个[问题排查](troubleshooting#gw_fbi)

##### Section V - Installing CIAs

1. Launch Health and Safety (which is now FBI)
1. Navigate to `SD` -> `cias`
1. 选择”\<current directory>”
1. 选择”Install all CIAs”选项，并按(A)键确认
1. Press (Home) to exit FBI

##### Section VI - DSP Dump

1. Launch DSP1
1. Once it has completed, press (Start) to exit

##### Section VII - Restore Health and Safety

1. Reboot holding (Start) during boot to launch the Luma3DS chainloader menu
1. Launch GodMode9 by pressing (A)
1. Press (Home) to bring up the action menu
1. Select "More..."
1. Select "Restore H&S"
1. Press (A) to unlock SysNAND (lvl1) writing, then input the key combo given

##### Section VIII - CTRNAND Luma3DS

1. Reboot holding (Start) during boot to launch the Luma3DS chainloader menu
1. Launch GodMode9 by pressing (A)
1. Navigate to `[0:] SDCARD`
1. Press (Y) on `boot.firm` to copy it
1. Press (B) to return to the main menu
1. Navigate to `[1:] SYSNAND CTRNAND`
1. Press (Y) to paste a copy of `boot.firm`
1. Select "Copy path(s)"
1. Press (A) to unlock SysNAND (lvl1) writing, then input the key combo given
1. Press (B) to return to the main menu
1. 格式化完成后，同时按(R)键和(B)键，弹出你的SD卡
1. Remove your SD card from your device
1. Press (Start) to reboot your device with your SD card removed
  + Booting your device at least once with your SD card removed will allow you to configure the CTRNAND based Luma3DS installation
1. 使用方向键和A键来启用以下设置：    
  + **"Show NAND or user string in System Settings"**
1. Reinsert your SD card into your device
1. 按下(Start)键保存设置并重启

##### Section IX - NAND Backup

1. Boot your device while holding (Start) to launch the Luma3DS chainloader menu
1. Launch GodMode9 by pressing (A)
1. Press (Home) to bring up the action menu
1. Select "More..."
1. Select "Backup NAND"
1. 按(A)键继续
1. 格式化完成后，同时按(R)键和(B)键，弹出你的SD卡
1. 将你的 SD 卡插入到您的计算机
1. Copy `nand.bin` from the `/gm9out/` folder on your SD card to a safe location on your computer
  + Make backups in multiple locations (such as online file storage)
  + 备份文件可以在将来出现错误时将你的机器救砖
1. Delete `nand.bin` from the `/gm9out/` folder on your SD card after copying it
1. Reinsert your SD card into your device
1. 按下(Start)键保存设置并重启

___

{% capture notice-10 %}
你现在可以使用Luma3DS Updater来更新你的Luma3DS到最新版，只需运行该程序并按下(A)键。     
这和系统升级不是一回事；它只会下载并提取最新的Luma3DS文件。
This will only update the Luma3DS files on your SD card. If you boot your device without an SD card, it will use the version you placed in CTRNAND.    
{% endcapture %}

<div class="notice--info">{{ notice-10 | markdownify }}</div>

{% capture notice-6 %}   
You will now boot Luma3DS CFW SysNAND by default.    
你可以在启动时按下Select键，进入Luma3DS的设置菜单。    
You can now hold (Start) on boot to launch the Luma3DS chainloader menu (note that the Luma3DS chainloader menu is only displayed if there is more than one payload detected).
You can now hold (Start) + (Select) + (X) on boot to dump the ARM11 bootrom (`boot11.bin`), the ARM9 bootrom (`boot9.bin`), and your console unique OTP (`OTP.bin`) to the `/boot9strap/` folder on your SD card (note that this will not have any kind of prompt or message).
{% endcapture %}

<div class="notice--info">{{ notice-6 | markdownify }}</div>

To use [NTR CFW](https://github.com/44670/BootNTR/), install [BootNTR Selector](https://gbatemp.net/threads/432911/).
{: .notice--info}

{% capture notice-7 %}
Remove any extra files and folders from the root of your SD card that are *not* in the following image:
<br><br>
![]({{ base_path }}/images/screenshots/final-file-layout.png)
{% endcapture %}

<div class="notice--info">{{ notice-7 | markdownify }}</div>

要想了解如何变更你的设备到另一个区域，参见[区域变更](region-changing) 页面。
{: .notice--success}

For information on using GodMode9's various features, check out the [GodMode9 Usage](godmode9-usage) page.
{: .notice--success}

要想了解如何使用Luma3DS的各种功能，参见[这个wiki](https://github.com/AuroraWright/Luma3DS/wiki/Options-and-usage).
{: .notice--success}

For information on installing custom themes, badges, and splash screens, check out [3dsthem.es](https://3dsthem.es/about.php).
{: .notice--success}